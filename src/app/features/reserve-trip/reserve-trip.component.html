<app-header></app-header>

<div class="reserve-container">
  <div class="reserve-form">
    <mat-card>
      <div class="trip-detail-title"> {{ routeState.operator | uppercase }} BUS   {{ routeState.departureLocation}} To {{routeState.arrivalLocation}}</div>

      <form class="my-form" [formGroup]="reserveRegisterForm" >
        <mat-form-field class="full-width" style="margin-right: 140px;">
          <mat-label>Full Name</mat-label>
          <input  matInput  placeholder="Full Name"  name="fname" formControlName="name"  required>
        </mat-form-field>
        <mat-form-field class="full-width">
          <mat-label>Phone Number</mat-label>
          <input  matInput formControlName="phone" placeholder="Phone Number" name="address"  required>
        </mat-form-field>
        <mat-form-field class="full-width">
          <mat-label>Luggage Weight</mat-label>
          <input type="number"  matInput  placeholder="Luggage Weight" formControlName="laggage" >
        </mat-form-field>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Select Your Seat</mat-label>
          <mat-select formControlName="seatNum">
            <mat-option *ngFor="let seatnumber of routeState.availableSeats" [value]="seatnumber">{{seatnumber}}</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field appearance="fill" class="full-width">
          <mat-label>Payment Method</mat-label>
          <mat-select formControlName="paymentMethod" [(ngModel)]="paymentMethod">
            <mat-option value="BankTransfer">Bank Transfer</mat-option>
            <mat-option value="TeleBirr">Tele Birr</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field  appearance="fill" class="full-width" *ngIf="paymentMethod == 'BankTransfer'">
          <mat-label>Select Bank Account</mat-label>
          <mat-select formControlName="accountId">
            <mat-option *ngFor="let account of accounts" [value]="account.reservationBankAccountsId">{{account.name}}</mat-option>
          </mat-select>
        </mat-form-field>
        &nbsp; &nbsp;&nbsp; <mat-spinner *ngIf="loading" diameter="20" color="accent" ></mat-spinner>
        <div class="action-buttons" *ngIf="!loading">
          <a (click)="reserve()" class="heading-button-right action-buton"  mat-flat-button   color="success">

            Reserve</a>

          <a  [routerLink]="['/home']"  class="heading-button-right action-buton" mat-flat-button   color="accent">Cancel</a>
          <a  (click)="backFunction()"  class="heading-button-right action-buton"  mat-flat-button  color="back">Back</a>
        </div>

      </form>
    </mat-card>
  </div>
  <div class="reserved-trip-detail">
    <mat-card>
      <div class="trip-detail-title">Trip Detail</div>
      <div class="trip-detail-item">
        <i class="material-icons trip-result-icon">
          event
        </i>
        <span class="trip-detail-property">Trip Date :</span>:
        <span class="trip-detail-value">{{ routeState.tripDate|date:"MMM,dd,yyyy"}}</span>
      </div>
      <div class="trip-detail-item">
        <i class="material-icons trip-result-icon">
          place
        </i><span class="trip-detail-property">Route</span>:
        <span class="trip-detail-value">{{ routeState.departureLocation}} To {{routeState.arrivalLocation}}</span>
      </div>
      <div class="trip-detail-item">
        <i class="material-icons trip-result-icon">
          business
        </i><span class="trip-detail-property">Departure Station:</span>:
        <span class="trip-detail-value">{{routeState.departureStation}}</span>
      </div>
      <div class="trip-detail-item">
        <i class="material-icons trip-result-icon">
          business
        </i>
        <span class="trip-detail-property">Arrival Station:</span>:
        <span class="trip-detail-value"> {{routeState.arrivalStation}}</span>
      </div>
      <div class="trip-detail-item">
        <i class="material-icons trip-result-icon">
          watch_later
        </i>  <span class="trip-detail-property"> Departure Time</span>:
        <span class="trip-detail-value"> {{routeState.departureTime|date:"hh:mm"}}</span>
      </div>
      <div class="trip-detail-item">
        <i class="material-icons trip-result-icon">
          call
        </i>
        <span class="trip-detail-property">Departure Support Phone</span>:
        <span class="trip-detail-value">{{routeState.departureLocationPhone}}</span>
      </div>

      <div class="trip-detail-item">
        <i class="material-icons trip-result-icon">
          payments
        </i> <span class="trip-detail-property">Price:</span>:
        <span class="trip-detail-value">{{ routeState.price}} ETB</span>
      </div>

    </mat-card>
  </div>
</div>

<!--<div style="margin-top: 100px;" flex fxLayout="row" fxLayout.lt-sm="column" >-->
<!--  <div fxFlex="10%"></div>-->
<!--  <div fxFlex="60%">-->

<!--</div>-->
<!--<div fxFlex="20%">-->

<!--</div>-->
<!--</div>-->



<form [formGroup]="dynamicForm" (ngSubmit)="onSubmit()">
  <div class="card m-3">
      <div class="card-body">
          <div class="form-row">
              <div class="form-group">
                  <label>Number of Tickets</label>
                  <select formControlName="numberOfTickets" class="form-control" (change)="onChangeTickets($event)" [ngClass]="{ 'is-invalid': submitted && f.numberOfTickets.errors }">
                      <option value=""></option>
                      <option *ngFor="let i of [1,2,3,4,5,6,7,8,9,10]">{{i}}</option>
                  </select>
                  <div *ngIf="submitted && f.numberOfTickets.errors" class="invalid-feedback">
                      <div *ngIf="f.numberOfTickets.errors.required">Number of tickets is required</div>
                  </div>
              </div>
          </div>
      </div>
      <div *ngFor="let ticket of t.controls; let i = index" class="list-group list-group-flush">
          <div class="list-group-item">
              <h5 class="card-title">Ticket {{i + 1}}</h5>
              <div [formGroup]="ticket" class="form-row">
                  <div class="form-group col-6">
                      <label>Name</label>
                      <input type="text" formControlName="name"/>
                      
                      <div *ngIf="submitted && ticket.controls.name.errors" class="invalid-feedback">
                          <div *ngIf="ticket.controls.name.errors.required">Name is required</div>
                      </div>
                  
                  </div>
                  <div class="form-group col-6">
                      <label>Email</label>
                      <input type="text" formControlName="email"  />
                      <!--
                      <div *ngIf="submitted && ticket.controls.email.errors" class="invalid-feedback">
                          <div *ngIf="ticket.controls.email.errors.required">Email is required</div>
                          <div *ngIf="ticket.controls.email.errors.email">Email must be a valid email address</div>
                      </div>
                    -->
                  </div>
              </div>
          </div>
      </div>
      <div class="card-footer text-center">
          <button class="btn btn-primary mr-1">Buy Tickets</button>
          <button class="btn btn-secondary mr-1" type="reset" (click)="onReset()">Reset</button>
          <button class="btn btn-secondary" type="button" (click)="onClear()">Clear</button>
      </div>
  </div>
</form>